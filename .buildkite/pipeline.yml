env:
  BUILDKITE_ANALYTICS_TOKEN: "fWD5V1t8bzGtArDrZUJdRuzX"

steps:
  - label: ":rspec: RSpec unit"
    command: .buildkite/steps/run
    key: unit
    agents:
      queue: "hosted-queue"
    parallelism: 2
    env:
      BUILDKITE_SPLITTER_IDENTIFIER: "${BUILDKITE_BUILD_ID}_${BUILDKITE_STEP_KEY}"
      BUILDKITE_SPLITTER_TEST_FILE_PATTERN: "spec/unit/**/*_spec.rb"

  - label: "Acceptance"
    command: .buildkite/steps/run
    key: acceptance
    agents:
      queue: "hosted-queue"
    parallelism: 2
    env:
      BUILDKITE_SPLITTER_IDENTIFIER: "${BUILDKITE_BUILD_ID}_${BUILDKITE_STEP_KEY}"
      BUILDKITE_SPLITTER_TEST_FILE_PATTERN: "spec/acceptance/**/*_spec.rb"
